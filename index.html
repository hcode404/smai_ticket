<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>SMAI Connect - Pusher Chat</title>
    <script src="https://js.pusher.com/8.4.0/pusher.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #0f172a; color: white; font-family: sans-serif; }
        .chat-box { height: 400px; background: #1e293b; border: 1px solid #3b82f6; }
        .message { background: #334155; padding: 10px; border-radius: 12px; margin-bottom: 8px; width: fit-content; }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-md">
        <h1 class="text-3xl font-black text-blue-500 mb-4 text-center">SMAI LIVE CHAT</h1>
        
        <div id="messages" class="chat-box w-full rounded-t-2xl p-4 overflow-y-auto flex flex-col">
            <div class="text-slate-500 italic text-sm mb-4 text-center">מחובר לשרת SMAI-Pusher...</div>
        </div>

        <div class="flex bg-slate-800 p-2 rounded-b-2xl border-t border-slate-700">
            <input type="text" id="msgInput" placeholder="הקלד הודעה..." class="flex-grow bg-transparent p-2 outline-none text-sm">
            <button onclick="sendMessage()" class="bg-blue-600 px-6 py-2 rounded-xl font-bold hover:bg-blue-500 transition">שלח</button>
        </div>
    </div>

    

    <script>
        // הגדרות Pusher מהחשבון שלך
        Pusher.logToConsole = true;
        const pusher = new Pusher('c1a8f838306b98eb7e7a', {
            cluster: 'ap2',
            forceTLS: true
        });

        // הצטרפות לערוץ
        const channel = pusher.subscribe('my-channel');

        // האזנה להודעות חדשות
        channel.bind('my-event', function(data) {
            const messagesDiv = document.getElementById('messages');
            const newMessage = document.createElement('div');
            newMessage.className = 'message';
            newMessage.innerText = data.message;
            messagesDiv.appendChild(newMessage);
            
            // גלילה אוטומטית למטה
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        });

        // פונקציה לשליחת הודעה
        // הערה: בגלל שאין לנו שרת פייתון כרגע, נדמה את השליחה. 
        // ב-Pusher האמיתי, הלקוח שולח לשרת והשרת מפיץ לכולם.
        function sendMessage() {
            const input = document.getElementById('msgInput');
            const text = input.value;
            if (!text) return;

            // כאן בדרך כלל שולחים בקשת Fetch לשרת פייתון/Node.js
            // מכיוון שאתה רוצה הכל באתר אחד, אנחנו נשתמש ב-Debug console של Pusher כדי לבדוק את זה.
            console.log("שלחת הודעה: " + text);
            input.value = '';
            
            alert("הודעה נשלחה למערכת! כדי לראות אותה בצ'אט, עליך לשלוח אותה דרך ה-Debug Console ב-Pusher.");
        }
    </script>
</body>
</html>
